# Title  
Performance Analysis of Digital Flux-locked Loop Circuit with Different SQUID \(V-\phi\) Transfer Curves for TES Readout System  

# Author  
Nan Li et al.  

# Background  
Superconducting transition-edge sensors (TES) are ultra-low-noise detectors with energy resolution in the range of several to tens of \(\mathrm{eV}\). To achieve high signal-to-noise ratios, TES signals are typically coupled with low-noise direct current superconducting quantum interference devices (SQUIDs). However, SQUIDs are inherently nonlinear, necessitating a flux-locked loop (FLL) to enable linear amplification over a larger dynamic range. Digital FLL systems offer advantages such as simplified signal manipulation and increased dynamic range through flux-quanta counting and dynamic field compensation methods. These systems are widely used in applications like magnetoencephalogram (MEG), magnetocardiogram (MCG), and cosmic microwave background (CMB) experiments.  

# Motivation  
Despite their widespread use, detailed analyses of parameters affecting digital FLL performance, such as bandwidth and slew rate, are limited. This work investigates the impact of SQUID \(V-\phi\) curve shapes on digital FLL performance, aiming to provide a reliable model for designing digital flux negative feedback and multiplexing SQUID readout systems.  

# Methodology  
The SQUID-FLL circuit comprises a single-stage SQUID where the TES current is coupled to the input coil \(L_{in}\), converting it into a magnetic flux signal \(\phi_{in}\). The SQUID’s response is modeled as a sinusoidal function:  
\[
u_{err}(t)=A \sin \left(\frac{2 \pi}{\phi_{0}}\left[i_{in}(t) M_{in}-\frac{u_{o}(t) M_{fb}}{R_{fb}}+\phi_{offset}\right]\right) G_{1}+u_{offset}
\]  
The digital FLL operates via a closed-loop negative flux feedback circuit with a PID algorithm:  
\[
u_{o}(n)=\left(\frac{R_{2}}{R_{1}}+\frac{C_{1}}{C_{2}}\right) u_{err}(n)+\frac{\Delta t}{R_{1} C_{2}} \sum_{i=0}^{n} u_{err}(i)+\frac{R_{2} C_{1}}{\Delta t}\left[u_{err}(n)-u_{err}(n-1)\right]
\]  
Simulations emulated laboratory conditions, using a 23 Hz triangle wave input, 150 MSPS sampling rate, and 7 samples per frame. Locking conditions, bandwidth, slew rate, and noise contributions were analyzed. System bandwidth was derived as:  
\[
f_{c} \approx \frac{V_{\phi} G_{1} M_{f b}}{2 \pi R_{1} C_{2} R_{f b}}
\]  
and adjusted for system delay:  
\[
f_{c} \approx \frac{V_{\phi} G_{1} M_{f b} N_{s p} t_{s p}}{2 \pi R_{1} C_{2} R_{f b} t_{f m}}
\]  
Slew rate was calculated as:  
\[
\frac{\partial \phi_{f b}}{\partial t}=\frac{\phi_{l i n} N_{s p} t_{s p}}{2 R_{1} C_{2} t_{f m}}
\]  

# Results  
Simulations showed absolute error signals below \(10 \mu \phi_{0}\) and relative errors under 0.1\% under locking conditions. Bandwidth for \(C_{2}=2 \mathrm{nF}\) was 628 kHz, consistent with theoretical predictions. The slew rate was \(1.5 \phi_{0}/\mu \mathrm{s}\), with distortion occurring for signal rise times exceeding \(1.6 \mu \mathrm{s}\). Noise analysis revealed ADC/DAC quantization noise contributions of \(0.8 \mathrm{pA}/\sqrt{\mathrm{Hz}}\) (16-bit ADC) and \(0.6 \mathrm{pA}/\sqrt{\mathrm{Hz}}\) (16-bit DAC), significantly lower than TES noise. The system tracked X-ray pulses with rise times from \(4.4 \mu \mathrm{s}\) to \(281 \mu \mathrm{s}\), but distortion occurred at amplitudes exceeding \(7.8 \phi_{0}\).  

# Interpretation  
The FLL design was shown to be independent of SQUID \(V-\phi\) curve shapes, validated through simulations of three transfer function models. Bandwidth and slew rate depend on parameters like feedback capacitance, preamp gain, and integration time. System stability requires careful PID calibration to avoid oscillations. The delay-adjusted bandwidth formula and slew rate equation provide accurate performance predictions.  

# Implication  
This work offers a reliable framework for designing high-performance digital PID flux feedback and multiplexing readout systems. Recommendations include using high-resolution ADC/DAC components (≥16 bits) and large feedback resistors to minimize noise. Adjusting integration parameters or feedback resistance can enhance bandwidth and slew rate, critical for applications requiring high-fidelity signal tracking, such as X-ray spectroscopy or CMB experiments.